<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danganronpa Roll</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            box-sizing: border-box;
            user-select: none;
        }

        #board-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            flex-grow: 1;
            align-content: start;
        }

        .player-card {
            background-color: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: center;
        }

        .icon-wrapper {
            position: relative;
            width: 75px;
            height: 75px;
            margin-right: 15px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .player-icon {
            width: 100%;
            height: 100%;
            border: 2px solid #5a3a3a;
            background-color: #333;
            object-fit: cover;
        }

        .icon-wrapper::before, .icon-wrapper::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 90%;
            height: 6px;
            background-color: #ff0000;
            display: none;
            z-index: 10;
        }
        .icon-wrapper::before { transform: translate(-50%, -50%) rotate(45deg); }
        .icon-wrapper::after  { transform: translate(-50%, -50%) rotate(-45deg); }

        .player-card.excluded-state .icon-wrapper::before,
        .player-card.excluded-state .icon-wrapper::after { display: block; }
        .player-card.excluded-state .player-info-container, 
        .player-card.excluded-state .player-icon { opacity: 0.3; }

        .player-info-container { display: flex; flex-direction: column; flex-grow: 1; }
        
        .player-name {
            color: white;
            font-size: 0.95rem; 
            font-weight: bold; 
            margin-bottom: 5px;
            border-bottom: 1px dotted #444;
            width: fit-content;
        }

        .roll-row {
            display: flex;
            align-items: baseline;
            gap: 10px;
        }

        .player-roll-display {
            color: #ff3333; 
            font-size: 1.8rem;
            font-weight: bold;
        }

        .ability-mod {
            font-size: 1.2rem;
            font-weight: bold;
            display: none;
        }

        #controls-container {
            display: flex;
            justify-content: center;
            padding: 30px 0;
            margin-top: auto;
        }
        
        #main-roll-button {
            background-color: #cc0000;
            color: white;
            font-size: 1.6rem;
            font-weight: bold;
            padding: 15px 60px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        #main-roll-button:active { background-color: #8b0000; }
    </style>
</head>
<body>

    <div id="board-container"></div>

    <div id="controls-container">
        <button id="main-roll-button">Roll</button>
    </div>

    <script>
        const PLAYER_NAMES = [
            "Epi. K", 
            "Battler Ushiromiya", 
            "Pumpkin B.", 
            "Joniys", 
            "Charlotte", 
            "Elder Price", 
            "Snowby"
        ];

        const boardContainer = document.getElementById('board-container');
        const rollButton = document.getElementById('main-roll-button');

        function init() {
            for (let i = 0; i < PLAYER_NAMES.length; i++) {
                const card = document.createElement('div');
                card.className = 'player-card';
                const imagePath = `image_${i + 1}.png`;

                card.innerHTML = `
                    <div class="icon-wrapper" onclick="this.parentElement.classList.toggle('excluded-state')">
                        <img src="${imagePath}" class="player-icon" alt="P${i+1}" onerror="this.src='https://placehold.co/80?text=Error'">
                    </div>
                    <div class="player-info-container">
                        <div class="player-name">${PLAYER_NAMES[i]}</div>
                        <div class="roll-row">
                            <div class="player-roll-display" id="roll-${i}">--</div>
                            <div class="ability-mod" id="mod-${i}"></div>
                        </div>
                    </div>
                `;
                boardContainer.appendChild(card);
            }
        }

        function roll() {
            const cards = document.querySelectorAll('.player-card');
            cards.forEach((card, index) => {
                if (card.classList.contains('excluded-state')) return;

                const rollDisplay = document.getElementById(`roll-${index}`);
                const modDisplay = document.getElementById(`mod-${index}`);
                const playerName = PLAYER_NAMES[index];

                let baseRoll = Math.floor(Math.random() * 20) + 1;
                rollDisplay.textContent = baseRoll;
                if (playerName === "Snowby") {
                    const chance = Math.floor(Math.random() * 3);
                    modDisplay.style.display = "block";

                    if (chance === 1) { 
                        let penalty = Math.floor(baseRoll * 0.5);
                        modDisplay.textContent = `-${penalty}`;
                        modDisplay.style.color = "orange";
                    } 
                    else if (chance === 2) { 
                        let bonus = Math.floor(baseRoll * 0.5);
                        if (baseRoll + bonus > 20) {
                            bonus = 20 - baseRoll;
                        }
                        modDisplay.textContent = `+${bonus}`;
                        modDisplay.style.color = "limegreen";
                    } 
                    else { 
                        modDisplay.textContent = "+0";
                        modDisplay.style.color = "yellow";
                    }
                } else {
                    modDisplay.style.display = "none";
                }
            });
        }

        init();
        rollButton.addEventListener('click', roll);
    </script>
</body>
</html>